<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Oil Filling Weight Checker</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
body{
font-family: Arial;
background:#0f172a;
color:white;
padding:10px;
}

h2{
font-size:18px;
text-align:center;
margin-bottom:10px;
}

table{
border-collapse:collapse;
width:100%;
background:#111827;
display:block;
overflow-x:auto;
white-space:nowrap;
font-size:14px;
}

th,td{
border:1px solid #374151;
padding:8px;
text-align:center;
}
a{
background:blue;
color:white;
text-decoration: none;
}
input,select{
width:100%;
padding:6px;
box-sizing:border-box;
text-align:center;
}

button{
padding:10px 16px;
border:none;
border-radius:8px;
cursor:pointer;
font-weight:bold;
}

button:nth-child(3){
background:#ef4444;
color:white;
}

button:nth-child(4){
background:#22c55e;
color:white;
}
button:nth-child(5){
background:blue;
color:white;
}
.low{background:#dc2626;}
.high{background:#ea580c;}
.ok{background:#16a34a;}

.summary{
margin-top:15px;
font-size:16px;
}

.spec{
margin-bottom:10px;
display:flex;
gap:10px;
align-items:center;
flex-wrap:wrap;
}

.top{
display:flex;
gap:10px;
margin-bottom:10px;
flex-wrap:wrap;
}

/* PRINT FIX */
@media print {

body{
background:white !important;
color:black !important;
}

h2, span, th, td, label, div{
color:black !important;
}

button{
display:none !important;
}

/* single page shrink */
#pdfArea{
transform:scale(0.92);
transform-origin:top left;
width:100%;
}

table{
page-break-inside:avoid;
}

}

</style>
</head>

<body>

<div id="pdfArea">

<h2>Oil Filling Net Weight Checker</h2>

<div class="top">
Brand:
<select id="brand">
<option>SELECT</option>  
<option>OOM GOLD</option>
<option>NIHAR GOLD</option>
<option>OOM ADVANCE</option>
<option>NIHAR ADVANCE</option>
</select>

SKU:
<select id="sku">
<option>SELECT</option>
<option>35FT</option>
<option>50FT</option>
<option>60FT</option>
<option>90FT</option>
<option>160FT</option>
<option>450FT</option>
</select>

<button onclick="clearAll()">Clear</button>
<button onclick="downloadPDF()">PDF</button>
<button><a href="https://boopathy143.github.io/Production-/">Production</a></button>
</div>

<div class="spec">
Spec Min:
<input id="minSpec" type="number" step="0.01" value="28.8" oninput="calc()">

Spec Max:
<input id="maxSpec" type="number" step="0.01" value="29.6" oninput="calc()">
</div>

<table>
<tr>
<th>S.No</th>
<th>Empty Bottle</th>
<th>Filled Weight</th>
<th>Net Weight</th>
<th>Adjustment Needed</th>
</tr>

<script>
for(let i=1;i<=15;i++){
document.write(`
<tr>
<td>${i}</td>
<td><input class="b" oninput="calc()"></td>
<td><input class="c" oninput="calc()"></td>
<td class="d">0</td>
<td class="e">0</td>
</tr>
`);
}
</script>

</table>

<div class="summary">
Total Net Weight: <span id="total">0</span><br>
Average Net Weight: <span id="avg">0</span>
</div>

</div>

<script>

function calc(){
let b=document.querySelectorAll(".b");
let c=document.querySelectorAll(".c");
let d=document.querySelectorAll(".d");
let e=document.querySelectorAll(".e");

let min=parseFloat(document.getElementById("minSpec").value)||0;
let max=parseFloat(document.getElementById("maxSpec").value)||0;

let total=0,count=0;

for(let i=0;i<b.length;i++){
let empty=parseFloat(b[i].value)||0;
let fill=parseFloat(c[i].value)||0;

if(b[i].value!=="" && c[i].value!==""){
let net=fill-empty;
d[i].innerText=net.toFixed(2);
total+=net;
count++;

d[i].classList.remove("low","high","ok");
e[i].classList.remove("low","high","ok");

if(net<min){
let adj=min-net;
e[i].innerText="Add "+adj.toFixed(2);
d[i].classList.add("low");
e[i].classList.add("low");
}
else if(net>max){
let adj=net-max;
e[i].innerText="Reduce "+adj.toFixed(2);
d[i].classList.add("high");
e[i].classList.add("high");
}
else{
e[i].innerText="OK";
d[i].classList.add("ok");
e[i].classList.add("ok");
}

}else{
d[i].innerText="0";
e[i].innerText="0";
d[i].classList.remove("low","high","ok");
e[i].classList.remove("low","high","ok");
}
}

document.getElementById("total").innerText=total.toFixed(2);
document.getElementById("avg").innerText=count? (total/count).toFixed(2):0;
}

function clearAll(){
document.querySelectorAll("input").forEach(i=>i.value="");
document.querySelectorAll(".d").forEach(i=>i.innerText="0");
document.querySelectorAll(".e").forEach(i=>i.innerText="0");
document.getElementById("total").innerText="0";
document.getElementById("avg").innerText="0";
}

function downloadPDF(){
let element=document.getElementById("pdfArea");

let opt = {
margin:0.3,
filename:'Weight_Report.pdf',
image:{ type:'jpeg', quality:0.98 },
html2canvas:{ scale:1.2 },
jsPDF:{ unit:'in', format:'a4', orientation:'portrait' }
};

html2pdf().set(opt).from(element).save();
}

</script>

</body>
</html>
